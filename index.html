<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Turtle Fight - Brawlhalla Tarzı</title>
<style>
  body { margin:0; background:#111; font-family:sans-serif; overflow:hidden; }
  #menu, #gameOver { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; justify-content:center; align-items:center; flex-direction:column; color:white; }
  #menu { background:black; }
  #playBtn { padding:20px 40px; background:yellow; color:black; font-size:24px; cursor:pointer; border:none; margin-bottom:20px; }
  #characterSelect { display:flex; gap:50px; margin-top:20px; }
  .charBox { width:100px; height:100px; cursor:pointer; display:flex; justify-content:center; align-items:center; font-weight:bold; border:2px solid white; transition:transform 0.2s; }
  .charBox:hover { transform: scale(1.1); }
  #gameCanvas { display:block; margin:0 auto; background: linear-gradient(to top, #00111a, #003366); }
</style>
</head>
<body>

<div id="menu">
  <button id="playBtn">PLAY</button>
  <div id="characterSelect">
    <div class="charBox" id="purrioBox" style="background:blue;">Purrio</div>
    <div class="charBox" id="sanjaiBox" style="background:gold;">Sanjai</div>
    <div class="charBox" id="murrikoBox" style="background:purple;">Murriko</div>
  </div>
</div>

<canvas id="gameCanvas" width="800" height="400"></canvas>

<div id="gameOver" style="display:none;">
  Kazanan: <span id="winner"></span>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let gameState = 'menu';
let selectedChar = null;
let characters = {};
let keys = {};
let effects = [];
let winner = null;

// Karakter verileri
const charData = {
  Murriko: { color:'purple', x:100, y:300, width:50, height:50, health:3, jCount:0, jReady:true, kReady:true, superUsed:{} },
  Sanjai: { color:'gold', x:300, y:300, width:50, height:50, health:3, jCount:0, jReady:true, kReady:true, superUsed:{} },
  Purrio: { color:'blue', x:500, y:300, width:50, height:50, health:3, jCount:0, jReady:true, kReady:true, superUsed:{} }
};

// Karakter seçimi
document.getElementById('murrikoBox').onclick = ()=>selectedChar='Murriko';
document.getElementById('sanjaiBox').onclick = ()=>selectedChar='Sanjai';
document.getElementById('purrioBox').onclick = ()=>selectedChar='Purrio';

// Play tuşu
document.getElementById('playBtn').onclick = ()=>{
  if(!selectedChar) { alert('Bir karakter seç!'); return; }
  startGame();
};

function startGame(){
  gameState='playing';
  document.getElementById('menu').style.display='none';
  characters = JSON.parse(JSON.stringify(charData));
  effects=[];
  requestAnimationFrame(gameLoop);
}

// Tuş takibi
window.addEventListener('keydown', e=>{ keys[e.key.toUpperCase()]=true; });
window.addEventListener('keyup', e=>{ keys[e.key.toUpperCase()]=false; });

// Saldırı ve süper güç
function attack(char,key){
  let c = characters[char];
  if(!c) return;
  if(key==='J' && c.jReady){
    c.jCount++;
    c.jReady=false;
    setTimeout(()=>c.jReady=true,500);
    for(let other in characters){
      if(other!==char && !c.superUsed[other]){
        characters[other].health--;
      }
    }
  } else if(key==='K' && c.kReady && c.jCount>=3){
    c.kReady=false;
    c.jCount=0;
    for(let other in characters){
      if(other!==char && !c.superUsed[other]){
        characters[other].health--;
        c.superUsed[other]=true;
        if(char==='Murriko') effects.push({type:'yilan', target:other, start:Date.now()});
        if(char==='Sanjai') effects.push({type:'kasirga', target:other, start:Date.now()});
        if(char==='Purrio') effects.push({type:'yildirim', target:other, start:Date.now()});
        setTimeout(()=>{ c.superUsed[other]=false; },2000);
      }
    }
    setTimeout(()=>c.kReady=true,2000);
  }
}

// Karakter hareket ve efektler
function update(){
  for(let char in characters){
    let c = characters[char];
    if(keys['W']) c.y -=5;
    if(keys['S']) c.y +=5;
    if(keys['A']) c.x -=5;
    if(keys['D']) c.x +=5;
    if(keys['J']) attack(char,'J');
    if(keys['K']) attack(char,'K');

    // Ölünce 1 saniye sonra yeniden doğ
    if(c.health<=0){
      c.health=0;
      setTimeout(()=>{ c.health=3; c.jCount=0; c.x=100+Math.random()*400; c.y=300; },1000);
    }
  }

  // Efekt süresi
  effects = effects.filter(e=> Date.now() - e.start < 2000 );

  // Kazanan kontrol
  let alive = Object.values(characters).filter(c=>c.health>0);
  if(alive.length===1 && gameState==='playing'){
    winner=alive[0];
    gameState='gameOver';
    document.getElementById('winner').textContent = Object.keys(characters).find(k=>characters[k]===winner);
    document.getElementById('gameOver').style.display='flex';
    setTimeout(()=>{
      document.getElementById('gameOver').style.display='none';
      document.getElementById('menu').style.display='flex';
      gameState='menu';
    },5000);
  }
}

// Çizim ve animasyon
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Platform çizimi
  ctx.fillStyle='#444';
  ctx.fillRect(0,350,canvas.width,50);

  for(let char in characters){
    let c = characters[char];
    ctx.fillStyle = c.color;
    ctx.fillRect(c.x,c.y,c.width,c.height);

    // Karakter pozları ve silah animasyonu
    ctx.fillStyle='white';
    ctx.font='14px sans-serif';
    ctx.fillText(char,c.x,c.y-10);

    if(char==='Murriko'){ // Kılıç X şeklinde
      ctx.save();
      ctx.translate(c.x+25,c.y+25);
      ctx.rotate(Math.PI/4);
      ctx.fillRect(-2.5,-25,5,50);
      ctx.rotate(-Math.PI/2);
      ctx.fillRect(-2.5,-25,5,50);
      ctx.restore();
    }
    if(char==='Sanjai'){ // Spear
      ctx.save();
      ctx.translate(c.x+25,c.y+25);
      ctx.rotate(Math.sin(Date.now()/200)*0.5);
      ctx.fillRect(-2.5,-30,5,60);
      ctx.restore();
    }
    if(char==='Purrio'){ // Mınçık
      ctx.save();
      ctx.translate(c.x+25,c.y+25);
      ctx.rotate(Math.sin(Date.now()/100)*0.5);
      ctx.fillRect(-5,-5,10,10);
      ctx.restore();
    }
  }

  // Efektler
  effects.forEach(e=>{
    let c = characters[e.target];
    ctx.fillStyle = e.type==='yilan' ? 'green' : e.type==='kasirga' ? 'cyan' : 'yellow';
    ctx.beginPath();
    if(e.type==='yilan') ctx.fillRect(c.x+60,c.y-10,20,50);
    if(e.type==='kasirga') ctx.arc(c.x+25,c.y+25,40,0,2*Math.PI);
    if(e.type==='yildirim'){
      ctx.moveTo(c.x+25,c.y-50);
      ctx.lineTo(c.x+25,c.y);
      ctx.lineWidth=5;
      ctx.strokeStyle='yellow';
      ctx.stroke();
    }
    ctx.fill();
  });
}

function gameLoop(){
  if(gameState==='playing'){
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }
}
</script>

</body>
</html>
